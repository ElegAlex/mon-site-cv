---
// src/components/Skills.astro — Acte 5 : "Bento grid + Drawer"
const formations = [
  {
    id: "msic",
    title: "Executive Master 2 MSIC",
    org: "Paris 1 Panthéon-Sorbonne",
    year: "2024-2025",
    icon: "graduation-cap",
    subtitle: "Management des Systèmes d'Information et de Connaissances",
    contents: [
      "Stratégie d'organisation et conduite du changement",
      "Ingénierie des exigences",
      "Modélisation de l'entreprise et de son évolution",
      "Qualité, Arbitrage et Décision",
      "Gouvernance des SI et Direction de Projets",
      "Architecture d'entreprise et urbanisation des SIC",
      "Management des connaissances et Big Data",
      "Système d'information décisionnel et Data Mining",
    ],
    memoire: {
      title: "Les facteurs d'institutionnalisation des communs numériques dans l'administration",
      url: "https://communs-numeriques.fr/articles/memoire-institutionnalisation-communs-numeriques",
    },
  },
  {
    id: "droit",
    title: "Master 2 Droit & Sciences du Travail Européen",
    org: "Toulouse 1 Capitole",
    year: "2013-2014",
    icon: "balance-scale",
    subtitle: "",
    contents: [
      "Droit des relations individuelles de travail",
      "Droit du travail et structure sociétaire",
      "Droit social des entreprises en difficulté",
      "Droit pénal du travail",
      "Droit de l'emploi public",
      "Droit de la négociation collective",
      "Droit comparé du travail",
      "Droit social européen et international",
    ],
    memoire: {
      title: "Le poids des partenaires sociaux dans la création du droit social en Europe",
    },
  },
  {
    id: "itil",
    title: "ITIL® 4 Foundation",
    org: "PeopleCert",
    year: "Certifié",
    icon: "certificate",
    subtitle: "",
    contents: [
      "Le Système de Valeur des Services (SVS)",
      "Les 7 Principes Directeurs d'ITIL",
      "Amélioration Continue (Continual Improvement)",
      "Habilitation du Changement (Change Enablement)",
      "Gestion des Incidents (Incident Management)",
      "Gestion des Problèmes (Problem Management)",
      "Centre de Services (Service Desk)",
      "Gestion des Niveaux de Service (Service Level Management)",
      "Gestion des Demandes de Service (Service Request Management)",
    ],
  },
];

const techCategories = [
  {
    label: "Gestion",
    tags: ["ITIL", "Agile/Scrum", "RGPD", "Conduite du changement", "Gouvernance SI"],
  },
  {
    label: "Infrastructure",
    tags: ["VMware", "Docker", "Linux", "Windows Server", "Active Directory", "Centreon", "GLPI"],
  },
  {
    label: "Data & IA",
    tags: ["PostgreSQL", "Redis", "Neo4j", "RAG", "LangChain", "Elasticsearch"],
  },
  {
    label: "Développement",
    tags: ["NestJS", "Next.js", "React", "Symfony", "PHP", "Python", "TypeScript", "Node.js"],
  },
];
---

<section id="competences" class="py-24 min-h-screen">
  <div class="max-w-5xl mx-auto px-6">

    <h2 class="section-heading font-display text-3xl md:text-4xl font-bold mb-16">
      <span class="font-mono text-teal-500 mr-3">&gt;</span>Formation & Compétences
    </h2>

    <!-- Bento grid -->
    <div class="bento-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-16">

      {formations.map(f => (
        <button
          class="bento-item formation-trigger p-6 rounded-xl text-left cursor-pointer group transition-all"
          style="background: var(--skills-card-bg); border: 1px solid var(--skills-card-border);"
          data-formation={f.id}>
          <div class="flex items-center justify-between mb-3">
            <i class={`fas fa-${f.icon} text-amber-400 text-xl`}></i>
            <span class="font-mono text-xs" style="color: var(--skills-accent);">{f.year}</span>
          </div>
          <h3 class="font-display font-semibold text-base mb-1">{f.title}</h3>
          <p class="text-sm" style="color: var(--skills-text-muted);">{f.org}</p>
          {f.subtitle && <p class="text-xs mt-1" style="color: var(--skills-text-faint);">{f.subtitle}</p>}
          <span class="inline-flex items-center gap-1 text-xs font-mono mt-3 group-hover:opacity-100 transition-opacity" style="color: var(--skills-accent); opacity: 0.5;">
            Voir détails <i class="fas fa-chevron-right text-[10px]"></i>
          </span>
        </button>
      ))}

      <!-- Bloc métriques -->
      <div class="bento-item p-6 rounded-xl flex flex-col justify-center" style="background: rgba(45,143,143,0.1); border: 1px solid rgba(45,143,143,0.2);">
        <span class="font-mono text-4xl font-bold block" style="color: var(--skills-accent);">17+</span>
        <span class="text-sm mt-2" style="color: var(--skills-text-muted);">ans d'expérience en management</span>
        <span class="font-mono text-2xl font-bold block mt-3" style="color: #d4a953;">5+</span>
        <span class="text-sm mt-1" style="color: var(--skills-text-muted);">ans de direction IT (depuis 2020)</span>
        <span class="text-xs mt-2" style="color: var(--skills-text-faint);">CPAM · CARSAT · RSI · DRSM</span>
      </div>
    </div>

    <!-- Tech tags par catégorie -->
    <div class="tech-tags-container space-y-8">
      {techCategories.map(cat => (
        <div>
          <h3 class="font-mono text-xs tracking-widest uppercase mb-3" style="color: var(--skills-text-faint);">{cat.label}</h3>
          <div class="flex flex-wrap gap-2">
            {cat.tags.map(tag => (
              <span
                class="tech-tag font-mono text-xs px-3 py-1.5 rounded cursor-default transition-all hover:opacity-80"
                style="background: var(--skills-tag-bg); border: 1px solid var(--skills-tag-border); color: var(--skills-tag-text);">
                {tag}
              </span>
            ))}
          </div>
        </div>
      ))}
    </div>
  </div>

  {/* ── DRAWER ── */}
  <div id="formation-drawer" class="fixed inset-0 z-50 pointer-events-none">
    <div class="drawer-backdrop absolute inset-0 bg-black/0 transition-all duration-300"></div>
    <div class="drawer-panel absolute top-0 right-0 h-full w-full max-w-lg bg-[#0f1729] border-l border-white/10 translate-x-full transition-transform duration-300 ease-out overflow-y-auto pointer-events-auto">
      <button class="drawer-close absolute top-6 right-6 w-8 h-8 flex items-center justify-center rounded-full bg-white/5 hover:bg-white/10 text-white/60 hover:text-white transition-colors">
        <i class="fas fa-times"></i>
      </button>
      <div class="drawer-content p-8 pt-16"></div>
    </div>
  </div>

  <script define:vars={{ formations }}>
    window.__formations = formations;
  </script>
</section>

<style is:global>
  :root {
    --skills-card-bg: #f1f5f9;
    --skills-card-border: #e2e8f0;
    --skills-tag-bg: #f1f5f9;
    --skills-tag-border: #e2e8f0;
    --skills-tag-text: #475569;
    --skills-text-muted: #64748b;
    --skills-text-faint: #94a3b8;
    --skills-accent: #0f766e;
  }

  :root[data-theme="dark"] {
    --skills-card-bg: rgba(255, 255, 255, 0.05);
    --skills-card-border: rgba(255, 255, 255, 0.1);
    --skills-tag-bg: rgba(255, 255, 255, 0.05);
    --skills-tag-border: rgba(255, 255, 255, 0.1);
    --skills-tag-text: rgba(255, 255, 255, 0.6);
    --skills-text-muted: rgba(255, 255, 255, 0.5);
    --skills-text-faint: rgba(255, 255, 255, 0.3);
    --skills-accent: #2dd4bf;
  }
</style>
