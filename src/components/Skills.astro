---
// src/components/Skills.astro — Acte 5 : "Bento grid + Drawer"
const formations = [
  {
    id: "msic",
    title: "Executive Master 2 MSIC",
    org: "Paris 1 Panthéon-Sorbonne",
    year: "2024-2025",
    icon: "graduation-cap",
    subtitle: "Management des Systèmes d'Information et de Connaissances",
    contents: [
      "Stratégie d'organisation et conduite du changement",
      "Ingénierie des exigences",
      "Modélisation de l'entreprise et de son évolution",
      "Qualité, Arbitrage et Décision",
      "Gouvernance des SI et Direction de Projets",
      "Architecture d'entreprise et urbanisation des SIC",
      "Management des connaissances et Big Data",
      "Système d'information décisionnel et Data Mining",
    ],
    memoire: {
      title: "Les facteurs d'institutionnalisation des communs numériques dans l'administration",
      url: "https://communs-numeriques.fr/recherche/memoire.html",
    },
  },
  {
    id: "droit",
    title: "Master 2 Droit & Sciences du Travail Européen",
    org: "Toulouse 1 Capitole",
    year: "2013-2014",
    icon: "balance-scale",
    subtitle: "",
    contents: [
      "Droit des relations individuelles de travail",
      "Droit du travail et structure sociétaire",
      "Droit social des entreprises en difficulté",
      "Droit pénal du travail",
      "Droit de l'emploi public",
      "Droit de la négociation collective",
      "Droit comparé du travail",
      "Droit social européen et international",
    ],
    memoire: {
      title: "Le poids des partenaires sociaux dans la création du droit social en Europe",
    },
  },
  {
    id: "itil",
    title: "ITIL® 4 Foundation",
    org: "PeopleCert",
    year: "Certifié",
    icon: "certificate",
    subtitle: "",
    contents: [
      "Le Système de Valeur des Services (SVS)",
      "Les 7 Principes Directeurs d'ITIL",
      "Amélioration Continue (Continual Improvement)",
      "Habilitation du Changement (Change Enablement)",
      "Gestion des Incidents (Incident Management)",
      "Gestion des Problèmes (Problem Management)",
      "Centre de Services (Service Desk)",
      "Gestion des Niveaux de Service (Service Level Management)",
      "Gestion des Demandes de Service (Service Request Management)",
    ],
  },
];

const techCategories = [
  {
    label: "Gestion",
    tags: ["ITIL", "Agile/Scrum", "RGPD", "Conduite du changement", "Gouvernance SI", "Leadership IT"],
  },
  {
    label: "Infrastructure",
    tags: ["VMware", "Docker", "Linux", "Windows Server", "Active Directory", "Centreon", "GLPI", "Veeam", "PRTG"],
  },
  {
    label: "Data & IA",
    tags: ["PostgreSQL", "Redis", "Neo4j", "RAG", "LangChain", "Elasticsearch", "LLM"],
  },
  {
    label: "Développement",
    tags: ["NestJS", "Next.js", "React", "Symfony", "PHP", "Python", "TypeScript", "Node.js", "CI/CD"],
  },
];
---

<section id="competences" class="py-24 min-h-screen">
  <div class="max-w-5xl mx-auto px-6">

    <h2 class="section-heading font-display text-3xl md:text-4xl font-bold mb-16">
      <span class="font-mono text-teal-500 mr-3">&gt;</span>Formation & Compétences
    </h2>

    <!-- Bento grid — 4 colonnes avec subgrid sur les 3 premières -->
    <div class="bento-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-16"
         style="grid-template-rows: repeat(5, auto);">

      {formations.map(f => (
        <button
          class="bento-item formation-trigger p-6 rounded-xl text-left cursor-pointer group"
          style={`background: var(--sk-card-bg); border: 1px solid var(--sk-card-border); display: grid; grid-template-rows: subgrid; grid-row: span 5;`}
          data-formation={f.id}>
          {/* Ligne 1 — Icône + année */}
          <div class="flex items-center justify-between pb-3">
            <i class={`fas fa-${f.icon}`} style="color: #d4a953; font-size: 1.25rem;"></i>
            <span class="font-mono" style={`font-size: 0.75rem; color: var(--sk-accent);`}>{f.year}</span>
          </div>
          {/* Ligne 2 — Intitulé */}
          <h3 class="font-display font-semibold" style="font-size: 1rem;">{f.title}</h3>
          {/* Ligne 3 — Entité */}
          <p style={`font-size: 0.875rem; color: var(--sk-muted);`}>{f.org}</p>
          {/* Ligne 4 — Subtitle (vide si absent) */}
          <p style={`font-size: 0.75rem; color: var(--sk-faint);`}>{f.subtitle || '\u00A0'}</p>
          {/* Ligne 5 — CTA */}
          <span class="inline-flex items-center gap-1 font-mono group-hover:opacity-100 transition-opacity self-end pt-2" style={`font-size: 0.75rem; opacity: 0.5; color: var(--sk-accent);`}>
            Voir détails <i class="fas fa-chevron-right" style="font-size: 10px;"></i>
          </span>
        </button>
      ))}

      {/* Bloc métriques — 4e colonne, PAS subgrid, juste span 5 pour la hauteur */}
      <div class="bento-item p-6 rounded-xl flex flex-col justify-center"
           style="background: rgba(45,143,143,0.1); border: 1px solid rgba(45,143,143,0.2); grid-row: span 5;">
        <span class="font-mono font-bold" style={`font-size: 2.25rem; color: var(--sk-accent-strong);`}>18+</span>
        <span style={`font-size: 0.875rem; margin-top: 0.5rem; color: var(--sk-muted);`}>ans d'expérience en management</span>
        <span class="font-mono font-bold" style="font-size: 1.5rem; color: #d4a953; margin-top: 0.75rem;">5+</span>
        <span style={`font-size: 0.875rem; margin-top: 0.25rem; color: var(--sk-muted);`}>ans de direction IT (depuis 2020)</span>
        <span style={`font-size: 0.75rem; margin-top: 0.5rem; color: var(--sk-faint);`}>CPAM · CARSAT · RSI · DRSM</span>
      </div>
    </div>

    <!-- Tech tags -->
    <div class="tech-tags-container space-y-8">
      {techCategories.map(cat => (
        <div>
          <h3 class="font-mono" style={`font-size: 0.75rem; letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 0.75rem; color: var(--sk-faint);`}>{cat.label}</h3>
          <div class="flex flex-wrap gap-2">
            {cat.tags.map(tag => (
              <span
                class="tech-tag font-mono cursor-default"
                style={`font-size: 0.75rem; padding: 0.375rem 0.75rem; border-radius: 0.25rem; background: var(--sk-tag-bg); border: 1px solid var(--sk-tag-border); color: var(--sk-tag-text);`}>
                {tag}
              </span>
            ))}
          </div>
        </div>
      ))}
    </div>
  </div>

  {/* ── DRAWER ── */}
  <div id="formation-drawer" class="fixed inset-0 z-50 pointer-events-none">
    <div class="drawer-backdrop absolute inset-0 bg-black/0 transition-all duration-300"></div>
    <div class="drawer-panel absolute top-0 right-0 h-full w-full max-w-lg translate-x-full transition-transform duration-300 ease-out overflow-y-auto pointer-events-auto" style="background: #0f1729; border-left: 1px solid rgba(255,255,255,0.1);">
      <button class="drawer-close absolute top-6 right-6 w-8 h-8 flex items-center justify-center rounded-full text-white/60 hover:text-white transition-colors" style="background: rgba(255,255,255,0.05);">
        <i class="fas fa-times"></i>
      </button>
      <div class="drawer-content p-8 pt-16"></div>
    </div>
  </div>

  <script define:vars={{ formations }}>
    window.__formations = formations;
  </script>
</section>
